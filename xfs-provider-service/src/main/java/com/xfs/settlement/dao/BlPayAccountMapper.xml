<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="BL_PAY_ACCOUNT" > 
<!-- Result Map-->
<resultMap id="result_map_BL_PAY_ACCOUNT" type="com.xfs.settlement.model.BlPayAccount" >
	<result column="id" property="id"/>
	<result column="ownert_type" property="ownertType"/>
	<result column="owner" property="owner"/>
	<result column="account_name" property="accountName"/>
	<result column="account_bank" property="accountBank"/>
	<result column="account_branch_bank" property="accountBranchBank"/>
	<result column="account_no" property="accountNo"/>
	<result column="license_no" property="licenseNo"/>
	<result column="state" property="state"/>
	<result column="isdefault" property="isdefault"/>
	<result column="account_address" property="accountAddress"/>
	<result column="account_mobile" property="accountMobile"/>
	<result column="account_type" property="accountType"/>
	<result column="create_by" property="createBy"/>
	<result column="create_dt" property="createDt"/>
	<result column="modify_by" property="modifyBy"/>
	<result column="modify_dt" property="modifyDt"/>
	<result column="dr" property="dr"/>
	<result column="enterprise_id" property="enterpriseId"/>
</resultMap>

	<!-- bl_pay_account table all fields -->
	<sql id="Base_Column_List" >
		id,ownert_type,owner,account_name,license_no,account_bank,account_branch_bank,account_no,state,isdefault,account_address,account_mobile,account_type,create_by,create_dt,modify_by,modify_dt,dr,enterprise_id
	</sql>

	<!-- 查询条件 -->
	<sql id="Example_Where_Clause">
		<trim prefix=" WHERE " prefixOverrides="AND ">
			<if test="id != null" >and id = #{id}</if>
			<if test="ownertType != null" >and ownert_type = #{ownertType}</if>
			<if test="owner != null" >and owner = #{owner}</if>
			<if test="accountName != null" >and account_name = #{accountName}</if>
			<if test="accountBank != null" >and account_bank = #{accountBank}</if>
			<if test="accountBranchBank != null" >and account_branch_bank = #{accountBranchBank}</if>
			<if test="accountNo != null" >and account_no = #{accountNo}</if>
			<if test="state != null" >and state = #{state}</if>
			<if test="isdefault != null" >and isdefault = #{isdefault}</if>
			<if test="accountAddress != null" >and account_address = #{accountAddress}</if>
			<if test="accountMobile != null" >and account_mobile = #{accountMobile}</if>
			<if test="accountType != null" >and account_type = #{accountType}</if>
			<if test="createBy != null" >and create_by = #{createBy}</if>
			<if test="createDt != null" >and create_dt = #{createDt}</if>
			<if test="modifyBy != null" >and modify_by = #{modifyBy}</if>
			<if test="modifyDt != null" >and modify_dt = #{modifyDt}</if>
			<if test="dr != null" >and dr = #{dr}</if>
			<if test="enterpriseId != null" >and enterprise_id = #{enterpriseId}</if>
		</trim>
	</sql>

	<!-- 查询条件 带模糊查询 以及 时间起始查询 -->
	<sql id="Example_Where_Clause2">
		<trim prefix=" WHERE " prefixOverrides="AND ">
			<if test="id != null">AND id = #{id}</if>
			<if test="ownertType != null">AND ownert_type like '%${ownertType}%'</if>
			<if test="ownertTypeEq != null">AND ownert_type = #{ownertTypeEq}</if>
			<if test="owner != null">AND owner = #{owner}</if>
			<if test="accountName != null">AND account_name like '%${accountName}%'</if>
			<if test="accountNameEq != null">AND account_name = #{accountNameEq}</if>
			<if test="accountBank != null">AND account_bank like '%${accountBank}%'</if>
			<if test="accountBankEq != null">AND account_bank = #{accountBankEq}</if>
			<if test="accountBranchBank != null">AND account_branch_bank like '%${accountBranchBank}%'</if>
			<if test="accountBranchBankEq != null">AND account_branch_bank = #{accountBranchBankEq}</if>
			<if test="accountNo != null">AND account_no like '%${accountNo}%'</if>
			<if test="accountNoEq != null">AND account_no = #{accountNoEq}</if>
			<if test="state != null">AND state like '%${state}%'</if>
			<if test="stateEq != null">AND state = #{stateEq}</if>
			<if test="isdefault != null">AND isdefault like '%${isdefault}%'</if>
			<if test="isdefaultEq != null">AND isdefault = #{isdefaultEq}</if>
			<if test="accountAddress != null">AND account_address like '%${accountAddress}%'</if>
			<if test="accountAddressEq != null">AND account_address = #{accountAddressEq}</if>
			<if test="accountMobile != null">AND account_mobile like '%${accountMobile}%'</if>
			<if test="accountMobileEq != null">AND account_mobile = #{accountMobileEq}</if>
			<if test="accountType != null">AND account_type like '%${accountType}%'</if>
			<if test="accountTypeEq != null">AND account_type = #{accountTypeEq}</if>
			<if test="createBy != null">AND create_by = #{createBy}</if>
			<if test="createDt != null">AND create_dt = #{createDt}</if>
			<if test="createDtFrom != null">AND create_dt&gt;=#{createDtFrom}</if>
			<if test="createDtTo != null">AND create_dt&lt;=#{createDtTo}</if>
			<if test="modifyBy != null">AND modify_by = #{modifyBy}</if>
			<if test="modifyDt != null">AND modify_dt = #{modifyDt}</if>
			<if test="modifyDtFrom != null">AND modify_dt&gt;=#{modifyDtFrom}</if>
			<if test="modifyDtTo != null">AND modify_dt&lt;=#{modifyDtTo}</if>
			<if test="dr != null">AND dr = #{dr}</if>
			<if test="enterpriseId != null">AND enterprise_id = #{enterpriseId}</if>
		</trim>
	</sql>

	<!-- 插入记录 -->
	<insert id="InsertBL_PAY_ACCOUNT" parameterType="Object" >
		INSERT INTO BL_PAY_ACCOUNT (
		<trim prefix=" " prefixOverrides=",">
			<if test="id != null ">,id</if>
			<if test="ownertType != null ">,ownert_type</if>
			<if test="owner != null ">,owner</if>
			<if test="accountName != null ">,account_name</if>
			<if test="accountBank != null ">,account_bank</if>
			<if test="licenseNo != null ">,license_no</if>
			<if test="accountBranchBank != null ">,account_branch_bank</if>
			<if test="accountNo != null ">,account_no</if>
			<if test="state != null ">,state</if>
			<if test="isdefault != null ">,isdefault</if>
			<if test="accountAddress != null ">,account_address</if>
			<if test="accountMobile != null ">,account_mobile</if>
			<if test="accountType != null ">,account_type</if>
			<if test="createBy != null ">,create_by</if>
			<if test="createDt != null ">,create_dt</if>
			<if test="modifyBy != null ">,modify_by</if>
			<if test="modifyDt != null ">,modify_dt</if>
			<if test="dr != null ">,dr</if>
			<if test="enterpriseId != null ">,enterprise_id</if>
		</trim>
		)  VALUES (
		<trim prefix=" " prefixOverrides=",">
			<if test="id != null ">,#{id}</if>
			<if test="ownertType != null ">,#{ownertType}</if>
			<if test="owner != null ">,#{owner}</if>
			<if test="accountName != null ">,#{accountName}</if>
			<if test="accountBank != null ">,#{accountBank}</if>
			<if test="licenseNo != null ">,#{licenseNo}</if>
			<if test="accountBranchBank != null ">,#{accountBranchBank}</if>
			<if test="accountNo != null ">,#{accountNo}</if>
			<if test="state != null ">,#{state}</if>
			<if test="isdefault != null ">,#{isdefault}</if>
			<if test="accountAddress != null ">,#{accountAddress}</if>
			<if test="accountMobile != null ">,#{accountMobile}</if>
			<if test="accountType != null ">,#{accountType}</if>
			<if test="createBy != null ">,#{createBy}</if>
			<if test="createDt != null ">,#{createDt}</if>
			<if test="modifyBy != null ">,#{modifyBy}</if>
			<if test="modifyDt != null ">,#{modifyDt}</if>
			<if test="dr != null ">,#{dr}</if>
			<if test="enterpriseId != null ">,#{enterpriseId}</if>
		</trim>
		)
		<selectKey resultType="java.lang.Integer" order="AFTER" keyProperty="id">
			SELECT LAST_INSERT_ID() AS ID
		</selectKey>
	</insert>

	<!-- 根据id，修改记录-->
	<update id="UpdateBL_PAY_ACCOUNT" parameterType="Object" >
		UPDATE BL_PAY_ACCOUNT
		<trim prefix=" SET " prefixOverrides=",">
			<if test="id != null ">,id=#{id}</if>
			<if test="ownertType != null ">,ownert_type=#{ownertType}</if>
			<if test="owner != null ">,owner=#{owner}</if>
			<if test="accountName != null ">,account_name=#{accountName}</if>
			<if test="accountBank != null ">,account_bank=#{accountBank}</if>
			<if test="licenseNo != null ">,license_no=#{licenseNo}</if>
			<if test="accountBranchBank != null ">,account_branch_bank=#{accountBranchBank}</if>
			<if test="accountNo != null ">,account_no=#{accountNo}</if>
			<if test="state != null ">,state=#{state}</if>
			<if test="isdefault != null ">,isdefault=#{isdefault}</if>
			<if test="accountAddress != null ">,account_address=#{accountAddress}</if>
			<if test="accountMobile != null ">,account_mobile=#{accountMobile}</if>
			<if test="accountType != null ">,account_type=#{accountType}</if>
			<if test="createBy != null ">,create_by=#{createBy}</if>
			<if test="createDt != null ">,create_dt=#{createDt}</if>
			<if test="modifyBy != null ">,modify_by=#{modifyBy}</if>
			<if test="modifyDt != null ">,modify_dt=#{modifyDt}</if>
			<if test="dr != null ">,dr=#{dr}</if>
			<if test="enterpriseId != null ">,enterprise_id=#{enterpriseId}</if>
		</trim>
		WHERE ID=#{id}
	</update>

	<!-- 删除记录 -->
	<delete id="DeleteBL_PAY_ACCOUNT">DELETE FROM BL_PAY_ACCOUNT WHERE ID=#{id}</delete>
	<!-- 任务单历史 列表总数-->
	<select id="CountFindAllBL_PAY_ACCOUNT" resultType="java.lang.Integer">SELECT count(1) as value FROM BL_PAY_ACCOUNT</select>
	<select id="CountBL_PAY_ACCOUNT" resultType="java.lang.Integer">SELECT count(1) as value FROM BL_PAY_ACCOUNT WHERE ID=#{id}</select>
	<!-- 根据id查询 任务单历史 -->
	<select id="FindByPK" resultMap="result_map_BL_PAY_ACCOUNT" parameterType="Object">SELECT <include refid="Base_Column_List" /> FROM BL_PAY_ACCOUNT WHERE ID=#{id}</select>

	<!-- 根据各字段条件带模糊查询  任务单历史 -->
	<select id="FreeFindBL_PAY_ACCOUNT" resultMap="result_map_BL_PAY_ACCOUNT" parameterType="Object">
		SELECT <include refid="Base_Column_List" /> FROM BL_PAY_ACCOUNT
		<include refid="Example_Where_Clause2" />
	</select>
	<!-- 根据各字段条件带模糊查询  任务单历史 记录数 -->
	<select id="CountFreeFindBL_PAY_ACCOUNT" resultType="java.lang.Integer">
		SELECT count(1) as value FROM BL_PAY_ACCOUNT
		<include refid="Example_Where_Clause2" />
	</select>
	<!-- 根据各字段条件带排序  任务单历史 -->
	<select id="FreeFindBL_PAY_ACCOUNTOrdered" resultMap="result_map_BL_PAY_ACCOUNT" parameterType="Object">
		SELECT <include refid="Base_Column_List" /> FROM BL_PAY_ACCOUNT
		<include refid="Example_Where_Clause2" />
		ORDER BY ${_orderBy}
	</select>

	<!-- *****************************  温馨提示：  ***************************** -->
	<!-- **                                                                    ** -->
	<!-- ** 以上为自动生成代码，请勿改动或删除。如有新sql添加请在下方区域内填写** -->
	<!-- **                                             ** 2016/11/30 21:54:12 ** -->
	<!-- ************************************************************************ -->




	<!-- 根据交易号和支付类型获取支付帐号信息 -->
	<select id="QUERY_PAY_ACCOUNT_LIST" resultType="java.util.Map" parameterType="Object">
		SELECT 	id,
		account_name as accountName,
		account_bank as accountBank,
		account_branch_bank as accountBranchBank,
		account_no as accountNo,
		isdefault,
		state
		FROM bl_pay_account account where account.state = 'USE' and account.dr = 0
		AND account.ownert_type = 'XFS'
	</select>

	<select id="getAccountInfo" parameterType="Object" resultType="Map">
		SELECT bpa.ownert_type
		,bpa.owner
		,bpa.account_name
		,bpa.account_bank
		,bpa.account_no
		,bpa.account_address
		,bpa.account_mobile
		,bpa.account_type
		FROM bl_pay_account bpa
		where bpa.owner=#{sp_id}
		and bpa.ownert_type=#{ownert_type}
		and bpa.account_type=#{account_type}
		and bpa.dr=0
	</select>

	<update id="modityAccount" parameterType="Object">
		update bl_pay_account bpa
		set bpa.dr=1
		where bpa.ownert_type='SERVICE'
		and bpa.owner=#{sp_id}
	</update>

	<insert id="addAccount" parameterType="Object">
		INSERT INTO BL_PAY_ACCOUNT (
		ownert_type
		,owner
		,account_name
		,account_bank
		,account_no
		,account_address
		,account_mobile
		,account_type
		,dr
		)  VALUES (
		'SERVICE'
		,#{sp_id}
		,#{account_name}
		,#{account_bank}
		,#{account_no}
		,#{account_address}
		,#{account_mobile}
		,#{account_type}
		,0
		)
	</insert>

</mapper>   
